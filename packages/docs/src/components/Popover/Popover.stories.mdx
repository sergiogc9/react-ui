import { ArgsTable, Meta, Story, Canvas } from 'storybook/utils/components';
import { getFixedStoryParams, getPlaygroundStoryParams } from 'storybook/parameters';
import Box from 'components/Box';
import Button from 'components/Button';
import Popover from 'components/Popover';
import PopoverContent from 'components/Popover/Content';
import PopoverTrigger from 'components/Popover/Trigger';
import PopoverWrapper from 'components/Popover/Wrapper';
import { PopoverWithoutProvider } from './Popover';

<Meta title="Components/Popover" component={PopoverContent} />

# Popover

This is a Popover component, helpful to show a Box content next to another component that acts as a trigger.

It is made with these components:

- **Popover**: The default exported namespaced component. It acts as a provider and it is a shortcut to all other components.
- **Trigger**: It acts as the trigger element which handles the trigger event to show and / or hide the popover content.
- **Content**: The popover content Box element shown when trigger event occurs.
- **Wrapper**: The component that handles the logic to show and hide the content, as well other stuff. It is based on the Tippy library.

**IMPORTANT**: Only use the `Popover.Wrapper` component to create a custom Popover content components (e.g. the `Popover.Content` and `Tooltip.Content` use it). If you want to use the default Popover content styling, use the Popover Content component.

<Story name="playground" args={{}} parameters={getPlaygroundStoryParams()}>
	{args => (
		<Popover>
			<Popover.Trigger>
				<Button>Hover me</Button>
			</Popover.Trigger>
			<Popover.Content {...args}>This is awesome</Popover.Content>
		</Popover>
	)}
</Story>

## Timing

You can change the enter and exit timing using the `enterDelay` and `exitDelay` props:

<Canvas>
	<Story name="enter timing" parameters={getFixedStoryParams()}>
		{args => (
			<Popover>
				<Popover.Trigger>
					<Button>Hover me</Button>
				</Popover.Trigger>
				<Popover.Content enterDelay={1000}>I took a second to be here!</Popover.Content>
			</Popover>
		)}
	</Story>
	<Story name="exit timing" parameters={getFixedStoryParams()}>
		{args => (
			<Popover>
				<Popover.Trigger ml="150px">
					<Button>Hover me</Button>
				</Popover.Trigger>
				<Popover.Content exitDelay={3000}>I will be gone in 3 seconds ðŸ˜„</Popover.Content>
			</Popover>
		)}
	</Story>
</Canvas>

## Interactive popover

By default, the popover is hidden when mousing out the trigger. This behavior can be changed using the `isInteractive` prop:

<Canvas>
	<Story name="not interactive" parameters={getFixedStoryParams()}>
		{args => (
			<Popover>
				<Popover.Trigger>
					<Button>Hover me</Button>
				</Popover.Trigger>
				<Popover.Content isInteractive={false}>I'm hiding when you mouse out the icon</Popover.Content>
			</Popover>
		)}
	</Story>
	<Story name="interactive" parameters={getFixedStoryParams()}>
		{args => (
			<Popover>
				<Popover.Trigger ml="150px">
					<Button>Hover me</Button>
				</Popover.Trigger>
				<Popover.Content isInteractive={true}>I keep opened if you hover me</Popover.Content>
			</Popover>
		)}
	</Story>
</Canvas>

## Changing trigger event

By default, the popover is shown when hovering the trigger. You can change it using the `trigger` prop:

<Canvas>
	<Story name="on hover" parameters={getFixedStoryParams()}>
		{args => (
			<Popover>
				<Popover.Trigger width="fit-content">
					<Button>Hover me</Button>
				</Popover.Trigger>
				<Popover.Content trigger="mouseenter focus">You hovered it!</Popover.Content>
			</Popover>
		)}
	</Story>
	<Story name="on click" parameters={getFixedStoryParams()}>
		{args => (
			<Popover>
				<Popover.Trigger ml="150px" width="fit-content">
					<Button>Click me</Button>
				</Popover.Trigger>
				<Popover.Content trigger="click">You clicked it!</Popover.Content>
			</Popover>
		)}
	</Story>
</Canvas>

## Using without provider and trigger

You can use the popover without the provider and trigger, using the `reference` prop with the element that will act as the trigger.

<Canvas>
	<Story
		name="without provider"
		parameters={{
			...getFixedStoryParams(),
			docs: {
				source: {
					code: `
  const ref = React.useRef(null);
  return (
      <Box ref={ref}>Hover me</Box>
      <Popover.Content reference={ref}>
        I am not using the provider!
      </Popover.Content>
  );
};`
				}
			}
		}}
	>
		{args => <PopoverWithoutProvider />}
	</Story>
</Canvas>

## Positioning

You can locate the popover in different places around the trigger component. See the `placement` prop for all values:

<Canvas>
	<Story name="positioning" parameters={getFixedStoryParams()}>
		{args =>
			['top', 'left', 'right', 'bottom'].map(position => (
				<Box key={`${position}-div`} py={5} flexWrap="wrap">
					{['', '-end', '-start'].map((alignment, index) => (
						<Popover key={`${position}${alignment}`}>
							<Popover.Trigger mx="100px" my="150px">
								<Button>Hover me</Button>
							</Popover.Trigger>
							<Popover.Content isVisible={true} placement={`${position}${alignment}`} height="150px" width="150px">
								{`This is the popover content with position: ${position}${alignment}`}
							</Popover.Content>
						</Popover>
					))}
				</Box>
			))
		}
	</Story>
</Canvas>

# Popover Content API

<ArgsTable of={PopoverContent} />

# Popover Wrapper API

<ArgsTable of={PopoverWrapper} />

# Popover Trigger API

<ArgsTable of={PopoverTrigger} />
